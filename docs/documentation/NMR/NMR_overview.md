## Diamagnetic Insulators
By a diamagnetic insulator we mean a system with an electronic gap between its highest occupied state and lowest unoccupied state, and all of the electronic spins are paired, simple examples are diamond, quartz, glycineâ€¦ This class of materials is the most suitable for calculations as the main NMR interactions, magnetic sielding, J-coupling and electric field gradients can all be computed.

###Magnetic Shielding
In a diamagnetic insulator this arises from orbital currents induced by an external magnetic field. This current ${\bf j}({\bf r})$,
 produces a non-uniform induced magnetic field in the material,
which is given by the Biot-Savart law as


$${\bf B}_{\rm in}({\bf r})
=\frac{1}{c}\int d^3r' {\bf j}({\bf r}')\times \frac{{\bf
    r}-{\bf r}'}{|{\bf r}-{\bf r}'|^3}. $$


The shielding tensor is defined as the ratio between this
induced field, and the external applied field

$${\bf B}_{\rm in}({\bf r})=-{\vec{\sigma}}({\bf r}){\bf B}_{\rm
  ext}.$$

It can thus be seen that the question of computing the shielding tensor is that of computing the induced electronic current.

### J-coupling
The J-coupling is a small
perturbation to the electronic ground-state of the system and we can
identify it as a derivative of the total energy E, of the system

$${\bf J}_{\rm KL}= \frac{\hbar\gamma_{\rm K}\gamma_{\rm
    L}}{2\pi}\frac{\partial^2 E}{\partial {\bf m}_{\rm K} \partial
  {\bf m}_{\rm L}}$$

An equivalent expression arises from considering one nuclear spin (L) as perturbation which creates a magnetic field at a second (receiving) nucleus (K)

$${\bf B}^{(1)}_{\rm in}({\bf R}_{{\rm K}})  = \frac{2\pi}{\hbar\gamma_{{\rm K}}\gamma_{{\rm L}}}{\bf
  J}_{{\rm KL}} \cdot {\bf m}_{{\rm L}}.$$

Eqn.~\ref{eq:J} tells us that the question of computing J is essentially
that of computing the magnetic field induced indirectly by a nuclear magnetic moment.
When spin-orbit coupling is neglected we can consider the field as
arising from two, essentially independent, mechanisms. Firstly, the
magnetic moment can interact with electronic charge inducing an orbital
current ${\bf j}({\bf r})$,  which in turn creates a magnetic field at the other nuclei in
the system. This mechanism is similar to the case of magnetic shielding
in insulators. The second mechanism arises from the
interaction of the magnetic moment with the electronic spin, causing an
electronic  spin polarisation.
By working to first order in these quantities we can write the magnetic field
at atom ${\rm K}$ induced by the magnetic moment of atom ${\rm L}$ as

$$
{\bf B}^{(1)}_{\rm in}({\bf R}_{{\rm K}})  =  \frac{\mu_{0}}{4\pi}\int
{\bf m}^{(1)}({\bf r})\cdot \left[\frac{3{\bf r}_{{\rm K}}{\bf r}_{{\rm K}} -
|{\bf r}_{{\rm K}}|^{2}}{|{\bf r}_{{\rm K}}|^{5}}\right]\,{\rm
d}^{3}{\bf r} $$

$$+  \frac{\mu_{0}}{4\pi}\frac{8\pi}{3}\int {\bf m}^{(1)}({\bf r})
\delta({\bf r}_{{\rm K}})\,{\rm d}^{3}{\bf r} $$

$$ +  \frac{\mu_{0}}{4\pi}\int {\bf j}^{(1)}({\bf r})\times
\frac{{\bf r}_{{\rm K}}}{|{\bf r}_{{\rm K}}|^{3}}\,{\rm d}^{3}{\bf r}.$$

Several quantum chemistry packages provide the ability to compute J
coupling tensors in molecular systems (see Helgaker *et al*.[@Helgaker2008]} for
a review of methods). An approach to compute J tensors within the planewave-pseudopotential approach has recently been developed[@Joyce2007].

### EFG
For a nucleus with spin $>$1/2 the NMR response will
 include an interaction between the quadrupole moment of the nucleus, Q,
 and the electric field gradient (EFG) generated by the surrounding
 electronic structure. The EFG is a second rank, symmetric, traceless tensor $G({\bf r})$
 given by

$$G_{\alpha\beta}({\bf r}) = \frac{\partial E_{\alpha}({\bf r})}{\partial  r_{\beta}} -
\frac{1}{3}\delta_{\alpha\beta}\sum_{\gamma}\frac{\partial
  E_{\gamma}({\bf r})}{\partial r_{\gamma}} $$

where $\alpha,\beta,\gamma$ denote the Cartesian coordinates x,y,z and
$E_{\alpha}({\bf r})$ is the local electric field at the position ${\bf
  r}$, which can be calculated from the charge density $n({\bf r})$:
\begin{equation}
E_{\alpha}({\bf r})=\int d^3r \frac{n({\bf r})}{|{\bf r}-{\bf r}'|^3} (r_{\alpha}-r_{\alpha}').
\end{equation}
The EFG tensor is then equal to
\begin{equation}\label{eq:efg_rs}
G_{\alpha\beta}({\bf r}) = \int d^3r \frac{n({\bf r})}{|{\bf r}-{\bf
    r}'|^3}\left[ \delta_{\alpha\beta} -3
  \frac{(r_{\alpha}-r_{\alpha}')(r_{\beta}-r_{\beta}')}{|{\bf r}-{\bf
      r}'|^2}\right].
\end{equation}
The computation of electric field gradient tensors is less demanding than
either shielding or J-coupling tensors as it
requires only knowledge of the electronic ground state.
The LAPW approach in its implementation within the Wien
series of codes[@Blaha1990] has been widely used and shown to reliably predict
Electric Field Gradient (EFG) tensors[@Blaha1989]. The equivalent
formalism for the planewave/PAW approach is reported in Profeta *et al*.[@Profeta2003].

 The quadrupolar coupling constant, C$_Q$ and the asymmetry
 parameter, $\eta_Q$ can be obtained from the  the diagonalized electric
 field gradient tensor whose eigenvalues are
 labelled V$_{xx}$, V$_{yy}$, V$_{zz}$, such that $|V_{zz}|>|V_{yy}|>|V_{xx}|$:
\begin{equation}
C_{Q}=\frac{eV_{zz}Q}{h},
\end{equation}
where h is Planck's constant and
\begin{equation}
\eta_Q=\frac{V_{xx}-V_{yy}}{V_{zz}}.
\end{equation}
